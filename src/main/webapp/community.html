<!DOCTYPE html>
<html>
  <head>
    <title>Community Page</title>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="/js/navigation-loader.js"></script>
    <script src="/js/search-results-loader.js"></script>
    <script>

      /** Fetches users and adds them to the page. */
      function fetchUserList(){
        const url = '/user-list';
        fetch(url).then((response) => {
          return response.json();
        }).then((users) => {
          const list = document.getElementById('list');
          list.innerHTML = '';

          users.forEach((user) => {
            const userListItem = buildUserListItem(user);
            list.appendChild(userListItem);
          });
        });
      }

      /**
        * Builds a list element that contains a link to a user page, e.g.
        * <li><a href="/user-page.html?user=test@example.com">test@example.com</a></li>
        */
      function buildUserListItem(user){
        const userLink = document.createElement('a');
        userLink.setAttribute('href', '/user-page.html?user=' + user);
        userLink.appendChild(document.createTextNode(user));
        const userListItem = document.createElement('li');
        userListItem.appendChild(userLink);
        return userListItem;
      }

      /** Fetches data and populates the UI of the page. */
      function buildUI(){
        fetchUserList();
      }
    </script>
  </head>

  <body onload="buildUI();">
    <div class="container-fluid pt-5">	

        <nav class="navbar navbar-expand-sm navbar-light fixed-top justify-content-between" style="background-color: #89cca6">
          <ul class="navbar-nav" id="navigation">
            <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
            <li class="nav-item"><a class="nav-link font" href="/aboutus.html">About Our Team</a></li>
            <!-- <li class="nav-item"><a class="nav-link font" href="/sentiment.html">Sentiment</a></li>      -->
            <li class="nav-item"><a class="nav-link" href="/map.html">Map</a></li>
            <li class="nav-item"><a class="nav-link" href="/translate.html">Translate</a></li>
            <div class="divider"/>  
          </ul>
  
          <div class="search-container">
            <form class="form-inline" action="javascript:;" onsubmit="sendInput()" id="search-form">
              <input class="mr-sm-2" type="text" placeholder="Search Buddies" id="search-input">
              <button class="my-2 my-sm-0" type="submit"><i class="fa fa-search"></i></button>
            </form>
          </div>
        </nav>

      <div class="pt-5" id="content">
        <h1>Community Page</h1>
        <p>Here is a list of every user who has posted a message:</p>
        <hr/>
        <ul id="list">Loading...</ul>
      </div>
  </body>
</html>